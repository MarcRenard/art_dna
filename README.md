# Art DNA

AI-powered art style classification with explainable visual concepts and similarity search.

## Overview

Analyze artwork styles across **18 art genres** using interpretable AI models. Upload any painting to get:

- **Style predictions** with confidence scores
- **Visual concepts** explaining the classification
- **Similar artworks** from our dataset of 8,365+ paintings
- **Heatmap visualizations** showing what the AI focuses on

**Art Styles:** Abstractionism, Art Nouveau, Baroque, Byzantine Art, Cubism, Expressionism, Impressionism, Mannerism, Muralism, Neoplasticism, Pop Art, Primitivism, Realism, Renaissance, Romanticism, Suprematism, Surrealism, Symbolism

## Technical Architecture

- **CBM Classification**: EfficientNet-B3 → 37 AI-generated visual concepts → 18 art styles (F1: 0.72)
- **Training**: 50 epochs on Google Vertex AI with T4 GPUs
- **Visual Concepts**: Generated by Anthropic Claude Sonnet across entire dataset
- **CLIP K-Means**: Transformer embeddings + clustering for unsupervised style prediction
- **Similarity Search**: DeiT transformer embeddings (768-dim) for visual similarity
- **Explainability**: Grad-CAM visualizations for styles and concepts
- **Dataset**: 8,365 paintings, 50 artists, 18 art genres
- **Deployment**: Google Cloud Run with model storage on GCS

## Prerequisites

- Python 3.10+
- Docker (for containerized deployment)
- Download [Best Artworks of All Time](https://www.kaggle.com/datasets/ikarus777/best-artworks-of-all-time/data) dataset
- Download `cbm_weighted_best.pth` model (please contact team)

## Setup & Run

```bash
# Install dependencies
make install

# Extract dataset to raw_data/ directory
# Create dataset (first time only)
make build-dataset
```

```bash
# Run backend (terminal 1)
make run-backend

# Run frontend (terminal 2)
make run-frontend
```

Open `http://localhost:8501` to upload images and predict art styles.

## API Endpoints

**Production**: `https://art-dna-api-521843227251.europe-west1.run.app`

- `POST /predict_cbm` - Explainable classification with visual concepts
- `POST /predict_kmeans` - CLIP + K-means clustering for style prediction
- `GET /predict_kmeans/{session_id}` - Session-based CLIP + K-means prediction
- `POST /similar` - Visual similarity search using DeiT embeddings
- `GET /gradcam/{session_id}/style/{style}` - Style heatmap visualization
- `GET /gradcam/{session_id}/concept/{concept}` - Concept heatmap visualization
- `GET /describe` - Educational genre descriptions

## Deployment

```bash
# Docker
make build_container_local
make run_container_local

# GCP Cloud Run
make build_cloud
make deploy_to_cloud_run
```

## Commands

```bash
make help            # Show all commands
make build-dataset   # Build image dataset with 18 simplified genres
make train-model     # Train and save VGG16 model
make evaluate-model  # Evaluate model on test set
make run-backend     # Run FastAPI backend
make run-frontend    # Run Streamlit frontend
```

## Team

- [Adriana](https://github.com/lady-hamster)
- [Anna](https://github.com/AnnaShe78)
- [Kristina](https://github.com/TinaKgn)
- [Marc](https://github.com/MarcRenard)
- [Michael](https://github.com/michaelsmueller)
